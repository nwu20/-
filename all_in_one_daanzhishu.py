import streamlit as st
import random

# 1. 基础设置
st.set_page_config(page_title="终极答案之书", page_icon="🔮")

# 2. 核心数据字典
books_data = {
    "👑 甄嬛传": {
        "title": "🦚 寿康宫",
        "color": "#FFC0CB",  # 少女/贵气粉
        "subtitle": "心中默念困惑。自有娘娘指点迷津。",
        "btn_draw": "✨ 请小主开示 ✨",
        "btn_redraw": "🔄 退下吧，本宫要重新抽签",
        "footer": "大梦一场，终须醒。仅供娱乐。",
        "quotes": [
            {"text": "别人帮你，那是情分，不帮你，那是本分。", "role": "甄嬛", "advice": "建议：降低对他人的期待，万事靠自己。"},
            {"text": "容不容得下是娘娘的气度，能不能让娘娘容下是嫔妾的本事。", "role": "甄嬛", "advice": "建议：与其抱怨大环境，不如修炼真本事。"},
            {"text": "在这后宫中想要升，就必须猜得中皇上的心思。若想要活，就要猜得中其他女人的心思。", "role": "甄嬛", "advice": "建议：向上管理和同级管理，两手都要抓。"},
            {"text": "与其心生敬佩，不如自己便是那样的人。", "role": "甄嬛", "advice": "建议：别光顾着羡慕别人，立刻行动起来。"},
            {"text": "哪怕是做一枚棋子，也要做一枚有用的棋子。", "role": "安陵容", "advice": "建议：先体现自己的利用价值，才能留在牌桌上。"},
            {"text": "哪怕是这宫里的猫儿狗儿，也都是有身价的。", "role": "华妃", "advice": "建议：搞清楚自己的核心竞争力到底在哪。"},
            {"text": "不中用的人留在宫里也是白费米粮。", "role": "皇后", "advice": "建议：优化身边的人际圈子，远离消耗你的人。"},
            {"text": "喜怒不形于色，心事勿让人知。", "role": "甄嬛", "advice": "建议：低调做人，别把底牌全亮给别人。"},
            {"text": "再冷，也不该拿别人的血来暖自己。", "role": "甄嬛", "advice": "建议：守住底线，别为了私利去做亏心事。"},
            {"text": "在这宫里，有利用价值的人才能活下去。", "role": "浣碧", "advice": "建议：现实一点，提升自己的不可替代性。"},
            {"text": "这几年的情爱与时光，终究是错付了！", "role": "甄嬛", "advice": "建议：及时止损，莫再纠缠烂桃花。"},
            {"text": "那年杏花微雨，你说你是果郡王，或许从一开始便都是错的。", "role": "甄嬛", "advice": "建议：复盘一下，方向可能从一开始就跑偏了。"},
            {"text": "其实这世上谁离了谁都一样活，只是活得好不好的问题罢了。", "role": "沈眉庄", "advice": "建议：别太把某人当回事，地球没谁都照样转。"},
            {"text": "不过是把你当成了纯元皇后的替身罢了！", "role": "皇后", "advice": "建议：警惕自己是不是成了别人的“平替”或备胎。"},
            {"text": "你试过从天黑等到天亮的滋味吗？", "role": "华妃", "advice": "建议：不要在一棵树上吊死，早点洗洗睡。"},
            {"text": "宁可枝头抱香死，何曾吹落北风中。", "role": "沈眉庄", "advice": "建议：宁缺毋滥，保持你的高姿态。"},
            {"text": "以色事他人，能得几时好？", "role": "甄嬛", "advice": "建议：靠外表或讨好是不长久的，要靠硬实力。"},
            {"text": "任何时候都不要为不值得的人、不值得的事费时间、费心力。", "role": "甄嬛", "advice": "建议：断舍离！把宝贵的精力留给自己。"},
            {"text": "有些事，如果不说出来就是一个心结，说出来了就是一个耳光。", "role": "甄嬛", "advice": "建议：看破不说破，糊涂一点反而好。"},
            {"text": "情不知所起，一往而情深。", "role": "果郡王", "advice": "建议：听从内心的声音，勇敢去爱吧。"},
            {"text": "贱人就是矫情！", "role": "华妃", "advice": "建议：对付作精，千万别留情面。"},
            {"text": "臣妾做不到啊！", "role": "皇后", "advice": "建议：遇到不想接的锅，大声勇敢地拒绝！"},
            {"text": "这福气给你要不要啊？", "role": "叶澜依", "advice": "建议：别听别人画大饼，他不干的事你也别接。"},
            {"text": "翠果，打烂她的嘴。", "role": "齐妃", "advice": "建议：忍无可忍无需再忍，该出手时就出手。"},
            {"text": "粉色娇嫩，你如今几岁了？", "role": "四大爷", "advice": "建议：认清现实，别再自欺欺人了。"},
            {"text": "既然未能置我于死地，我便要看你死无葬身之地！", "role": "甄嬛", "advice": "建议：触底反弹！是时候绝地反击了。"},
            {"text": "今年的枫叶好像不够红啊。", "role": "华妃", "advice": "建议：是时候给对方一点颜色看看了。"},
            {"text": "放肆！本宫在此，谁敢造次！", "role": "华妃", "advice": "建议：气场拿出来！你才是全场的主角。"},
            {"text": "姐姐说笑了，妹妹哪有姐姐这般好福气。", "role": "安陵容", "advice": "建议：遇到阴阳怪气的人，就用魔法打败魔法。"},
            {"text": "算计别人，也要掂量掂量自己有没有那个本事！", "role": "皇后", "advice": "建议：别搞小动作，容易引火烧身。"},
            {"text": "凡事都要看淡些，心放宽了，日子才好过。", "role": "甄嬛", "advice": "建议：顺其自然，佛系面对一切。"},
            {"text": "有时候不争，比能争会争之人有福多了。", "role": "苏培盛", "advice": "建议：退一步海阔天空，躺平也是种智慧。"},
            {"text": "世间的阴差阳错从未停歇，都是寻常。", "role": "甄嬛", "advice": "建议：一切都是最好的安排，别太遗憾。"},
            {"text": "三阿哥又长高了。", "role": "齐妃", "advice": "建议：没话找话也是一种沟通策略，先打破尴尬再说。"},
            {"text": "这条命，这口气，我从来由不得自己。", "role": "安陵容", "advice": "建议：别内耗了，有些事确实是大环境背锅。"},
            {"text": "打雷的时候，臣妾好怕。", "role": "华妃", "advice": "建议：适时服软，示弱也是一种高明的武器。"},
            {"text": "既然已经错了，便错到底吧。", "role": "安陵容", "advice": "建议：有些事，既然做了就别回头，走下去看看。"},
            {"text": "人有喜怒哀乐，伤心流泪何罪之有。", "role": "甄嬛", "advice": "建议：允许自己崩溃一会，情绪需要发泄。"},
            {"text": "不偏爱，不尽信，才是大智慧。", "role": "太后", "advice": "建议：保持理性和客观，别盲目跟风。"},
            {"text": "这一等，竟是整整一个春天。", "role": "敬妃", "advice": "建议：好饭不怕晚，耐心等待时机。"}
        ]
    },
    "📻 潜伏": {
        "title": "📻 保密局",
        "color": "#36454F",  # 沉稳深灰色
        "subtitle": "心中默念困惑。听听吴站长怎么说。",
        "btn_draw": "☎️ 拨通专线，请站长指示",
        "btn_redraw": "挂断电话，重新请示",
        "footer": "绝密档案。阅后即焚。",
        "quotes": [
            {"text": "凝聚意志，保卫领袖，这八个字我研究了十五年，结果就是两个字：搞钱！", "role": "吴敬中", "advice": "建议：看透事物本质。别被虚假的口号忽悠。"},
            {"text": "嘴上都是主义，那心里全是生意。", "role": "吴敬中", "advice": "建议：别听别人唱高调。多看看他背后的利益驱动。"},
            {"text": "你断人家的财路，人家会断你的生路。", "role": "吴敬中", "advice": "建议：职场大忌。千万别乱动别人的蛋糕。"},
            {"text": "有人缘，就是有能力呀！", "role": "吴敬中", "advice": "建议：别光顾着埋头干活。搞好人际关系也是硬实力。"},
            {"text": "什么叫不合适？合适都是讲条件的。", "role": "吴敬中", "advice": "建议：别急着拒绝。筹码给够了什么都好谈。"},
            {"text": "本来想露脸，结果把屁股露出来了。", "role": "吴敬中", "advice": "建议：别急于表现自己。准备不足容易弄巧成拙。"},
            {"text": "信任是一种滑稽的好感，我求之，但不得之。", "role": "吴敬中", "advice": "建议：不要轻易相信任何人。凡事留个心眼。"},
            {"text": "你以为别人不知道，其实别人只是不说罢了。", "role": "吴敬中", "advice": "建议：别自作聪明。很多事大家只是看破不说破。"},
            {"text": "我不管什么大局，我只管我的余生。", "role": "吴敬中", "advice": "建议：少操心那些宏大叙事。先保全自己最重要。"},
            {"text": "这种事儿，不查都是天灾，一查全是人祸。", "role": "吴敬中", "advice": "建议：事情水很深。建议你不要随便去蹚浑水。"},
            {"text": "时间像一头野驴呀，跑起来就不停。", "role": "吴敬中", "advice": "建议：抓紧时间。别再拖延了。"},
            {"text": "峨眉峰，还他妈独照，颇具浪漫主义气质啊。", "role": "吴敬中", "advice": "建议：别整那些虚头巴脑的。务实一点。"},
            {"text": "活着，就有希望。", "role": "吴敬中", "advice": "建议：熬住。留得青山在不怕没柴烧。"},
            {"text": "事情既然已经到了这一步，后悔也没有用。", "role": "吴敬中", "advice": "建议：接受现实。向前看。"},
            {"text": "不是我们无能，是共军太狡猾。", "role": "吴敬中", "advice": "建议：适当原谅自己。有时候确实是大环境不行。"}
        ]
    },
    "🏮 大明王朝": {
        "title": "☯️ 玉熙宫",
        "color": "#DAA520",  # 皇家金
        "subtitle": "叩问天意。听听权力巅峰的回答。",
        "btn_draw": "📜 呈递青词，请皇上批红",
        "btn_redraw": "圣意难测，退回重拟",
        "footer": "大明国库空虚。少干废话，多干实事。",
        "quotes": [
            {"text": "做官要三思：思危、思退、思变。", "role": "吕芳", "advice": "建议：居安思危。提前给自己铺好退路。"},
            {"text": "长江水清，黄河水浊。只能不因水清而偏用，也只能不因水浊而偏废。", "role": "嘉靖帝", "advice": "建议：接受世界的灰度。别有太高的道德洁癖，用人做事看核心价值。"},
            {"text": "有些事不上称没有四两重，上了称一千斤也打不住。", "role": "杨金水", "advice": "建议：懂得抓大放小。别把小事闹大，也别让人抓住把柄。"},
            {"text": "大明朝只有一个人可以呼风唤雨，那就是皇上。只有一个人可以遮风挡雨，就是我，严嵩。", "role": "严嵩", "advice": "建议：认清局势。在团队里找到自己不可替代的位置。"},
            {"text": "任何人答应你的事都不算数，只有你自己能做主的事才算数。", "role": "嘉靖帝", "advice": "建议：放弃幻想。把主动权和控制权死死抓在自己手里。"},
            {"text": "你中有我，我中有你，天下事坏就坏在这里。", "role": "胡宗宪", "advice": "建议：警惕利益深度捆绑。该切割的时候必须当机立断。"},
            {"text": "文官袍服上织的是禽，武官袍服上绣的是兽。穿上这身袍服，你我哪个不是衣冠禽兽？", "role": "严嵩", "advice": "建议：看透人性的底色。别对规则和环境抱有太天真的期待。"},
            {"text": "云在青天水在瓶。", "role": "嘉靖帝", "advice": "建议：各安其分。认清自己当下的实力和位置，切忌僭越。"},
            {"text": "我海瑞无党！", "role": "海瑞", "advice": "建议：保持绝对的独立。不盲目站队有时就是最好的破局策略。"},
            {"text": "一两成银子救不了国家！", "role": "张居正", "advice": "建议：看清宏观大局。别在蝇头小利上浪费精力。"},
            {"text": "媳妇熬成婆，最痛恨媳妇的往往就是婆婆。", "role": "嘉靖帝", "advice": "建议：不要低估人性的阴暗面。别以为同病必定相怜。"},
            {"text": "不战而屈人之兵，善之善者也。", "role": "胡宗宪", "advice": "建议：硬碰硬是下策。多用策略和脑子解决问题。"},
            {"text": "朕的钱！他们拿两百万，朕分一百万！还要朕感谢他们吗？", "role": "嘉靖帝", "advice": "建议：认清核心利益。别让人拿了你的大头，还让你感恩戴德。"},
            {"text": "苦一苦百姓，骂名我来担。", "role": "赵贞吉", "advice": "建议：警惕冠冕堂皇的借口。别人揽虚名，代价却是你来承受。"},
            {"text": "一句瞎话，要用十句瞎话来圆。", "role": "吕芳", "advice": "建议：保持诚实。或者干脆闭嘴。撒谎的代价太高。"},
            {"text": "侯非侯，王非王，千乘万骑归邙山！", "role": "沈一石", "advice": "建议：看淡得失。无论眼下争到什么，最终结局都是尘归尘。"},
            {"text": "天下治与不治，在于理之明与不明。", "role": "海瑞", "advice": "建议：遇事必须先立规矩。一味和稀泥只会彻底崩盘。"},
            {"text": "他就像个媳妇。上面有公婆，中间有丈夫，底下有儿女。辛苦命，两头不讨好。", "role": "吕芳", "advice": "建议：跳出内耗陷阱。别再做那个受气包。该拒绝就拒绝。"},
            {"text": "大明朝满朝骨鲠，却没有一根定海神针！", "role": "海瑞", "advice": "建议：别指望别人光说不练。遇到危机，你得自己拍板。"},
            {"text": "上下挥霍无度，便掠之于民；民变在即，便掠之于商。", "role": "沈一石", "advice": "建议：看透食物链的残酷真相。身处下位时，务必懂得隐藏实力保全自己。"}
        ]   
    },
    "🥊 马大帅/范德彪": {
        "title": "🥊 开原维多利亚",
        "color": "#FF4500",  # 东北热血橙
        "subtitle": "咔咔一顿整。听听辽北第一狠人的处世哲学。",
        "btn_draw": "🥊 仰仗彪哥，请教这道上的事儿",
        "btn_redraw": "🔄 翻篇了，这就是一场梦",
        "footer": "论成败人生豪迈，大不了重头再来。",
        "quotes": [
            {"text": "我也不是当初那个我了，你也不是当初那个你了，咱们都回不到当初了。", "role": "范德彪", "advice": "建议：往前看吧，物是人非是常态。"},
            {"text": "在这场博弈中，我已经看破了你的底牌。", "role": "范德彪", "advice": "建议：自信一点！哪怕其实啥也没看出来，气场不能输。"},
            {"text": "那是咔咔一顿挠啊！", "role": "范德彪", "advice": "建议：别整虚的，该拼命的时候就得豁出去。"},
            {"text": "给这位大哥拿瓶维多利亚啤酒，算我账上。", "role": "范德彪", "advice": "建议：格局打开。有时候花点小钱能免大灾。"},
            {"text": "你不用跟我整这景儿，你就直接跟我说，这事儿能不能办？", "role": "范德彪", "advice": "建议：别被花言巧语绕进去。直奔主题看结果。"},
            {"text": "我这岁数，我这级别，我这身份，我能跟你整那景儿吗？", "role": "范德彪", "advice": "建议：利用你的“资历”作为挡箭牌，哪怕那是虚的。"},
            {"text": "我不是在这儿跟你吹牛，开原这块儿，谁不认识我范德彪？", "role": "范德彪", "advice": "建议：适当的自我包装是生存的刚需。"},
            {"text": "一切尽在不言中，都在这杯酒里了。", "role": "范德彪", "advice": "建议：有些事没法解释，干脆糊涂处理，大家面子上都过得去。"},
            {"text": "这辈子，我活的就是个面子！", "role": "范德彪", "advice": "建议：如果底子已经没了，那就死守住最后那点尊严。"},
            {"text": "我不差钱儿，我差的是一个机会。", "role": "范德彪", "advice": "建议：缺啥别缺志气，心态一定要稳住。"}
        ]
    }
}

# 3. 左侧边栏设计
st.sidebar.title("🔮 答案之书")
st.sidebar.markdown("请选择你要查阅的系统：")
book_choice = st.sidebar.radio("", list(books_data.keys()))

# 4. 状态管理
if 'current_book' not in st.session_state:
    st.session_state.current_book = book_choice

if st.session_state.current_book != book_choice:
    st.session_state.drawn = False
    st.session_state.result = None
    st.session_state.current_book = book_choice

if 'drawn' not in st.session_state:
    st.session_state.drawn = False
    st.session_state.result = None

# 5. 获取当前选中的内容
current_data = books_data[book_choice]

# 注入动态样式：改变标题颜色和按钮阴影
st.markdown(f"""
    <style>
    .main-title {{
        color: {current_data['color']};
        text-shadow: 1px 1px 2px #000;
    }}
    </style>
    """, unsafe_allow_html=True)

# 6. 主界面渲染
st.markdown(f"<h1 class='main-title'>{current_data['title']}</h1>", unsafe_allow_html=True)
st.subheader(current_data["subtitle"])
st.markdown("---")

# 7. 交互逻辑
if not st.session_state.drawn:
    if st.button(current_data["btn_draw"], use_container_width=True):
        st.session_state.result = random.choice(current_data["quotes"])
        st.session_state.drawn = True
        st.rerun()
else:
    res = st.session_state.result
    # 使用 info 和 success 容器，颜色会根据 streamlit 默认样式变化
    st.info(f"「 {res['text']} 」")
    st.caption(f"—— {res['role']}")
    st.success(f"**【批示】** {res['advice']}")
    
    st.markdown("---")
    
    if st.button(current_data["btn_redraw"], use_container_width=True):
        st.session_state.drawn = False
        st.rerun()

# 8. 页脚
st.markdown(f"<br><br><p style='text-align: center; color: gray; font-size: 14px;'>{current_data['footer']}</p>", unsafe_allow_html=True)